<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> 
</head>
<body>
    <img id="test" src="https://codingapple1.github.io/kona.jpg">

    <button id="click">클릭</button>
    <script>
        var 프로미스 = new Promise(function(성공,실패){
        var img = document.getElementById('test');
        
        img.addEventListener('load', function(){
                성공();
        });

        img.addEventListener('error', function(){
            실패();
        });

    });

    프로미스.then(function(){
       console.log('이미지로드 성공'); 
    }).catch(function(){
        console.log('이미지로드 실패');
    })


    var 프로미스1 = new Promise(function(성공,실패){
        $.get('https://codingapple1.github.io/hello.txt').done(function(data){
            성공(data);
        })

    })
    
    프로미스1.then(function(data){
        console.log(data);

        var 프로미스2 = new Promise(function(성공,실패){
            $.get('https://codingapple1.github.io/hello2.txt').done(function(data1){
                성공(data1)
            })
        })

        return 프로미스2;
    }).then(function(data1){
        console.log(data1);
    })

    // 함수 앞에서만 사용 가능 async

    // async만 붙이면 
    async function 더하기(){
      var 프로미스 = new Promise(function(성공,실패){
        var 힘든연산 = 1 + 1;
        성공();
      });
      
      // 프로미스가 해결될 때 까지 기다림 
      var 결과 = await 프로미스;
      console.log(결과);
      // await 은 프로미스 실패시 애러나고 멈춘다.

      /*
      프로미스.then(function(){
        console.log('성공했어요');
      })
    */

    }

    더하기();

    


        // async function 안에서 쓰는 await



        
            var 프로미스1 = new Promise(function(성공, 실패){
               document.getElementById('click').addEventListener('click', function(){
                    성공();
                })
                
            });

            async function 클릭(){  
            var 결과 = await 프로미스1; 
            console.log('성공');
            }

        클릭();

        







    








    </script>
    
</body>
</html>